{"pageContext":{"displayName":"Tracing - Docs","content":{"id":"tracing","displayName":"Tracing","description":"Overal documentation for Tracing","type":"Components","docs":[{"order":"001-overview-tracing","title":"Overview","source":"<p>The micro-services based architecture differs from the traditional monoliths in many aspects. From the request observability perspective, there are asynchronous boundaries among various different micro-services that compose a request flow. Moreover, these micro-services can have heterogeneous semantics when it comes to monitoring and observability. It is required to have a tracing solution that can provide a holistic view of the request flow and help the developer understand the system better to take informed decisions regarding troubleshooting and performance optimization.</p>\n<p>Tracing in Kyma uses <a href=\"https://www.jaegertracing.io/docs/\" target=\"_blank\">Jaeger</a> as a backend which serves as the query mechanism for displaying information about traces. Jaeger is used for monitoring and troubleshooting microservice-based distributed systems, including:</p>\n<ul>\n<li>Distributed context propagation</li>\n<li>Distributed transaction monitoring</li>\n<li>Root cause analysis</li>\n<li>Service dependency analysis</li>\n<li>Performance and latency optimization</li>\n</ul>\n<p>Jaeger provides compatibility with the Zipkin protocol. The compatibility makes it possible to use Zipkin protocol and clients in Istio, Envoy, and Kyma services.</p>\n<p>You can access the Jaeger UI either locally at <code>https://jaeger.kyma.local</code> or on a cluster at <code>https://jaeger.{domain-of-kyma-cluster}</code>. </p>\n"},{"order":"010-details-http-headers","title":"Propagate HTTP headers","type":"Details","source":"<p>The envoy proxy controls the inbound and outbound traffic in the application and automatically sends the trace information to the Zipkin. However, to track the flow of the REST API calls or the service injections in Kyma, it requires the minimal application cooperation from the micro-services code. For this purpose, you need to configure the application to propagate the tracing context in HTTP headers when making outbound calls. See the <a href=\"https://istio.io/docs/tasks/telemetry/distributed-tracing.html#understanding-what-happened\" target=\"_blank\">Istio documentation</a> for details on which headers are required to ensure the correct tracing in Kyma.</p>\n"},{"order":"020-architecture-tracing","title":"Architecture","source":"<p>See the diagram and steps for an overview of the tracing flow in Kyma:</p>\n<p><img src=\"assets/tracing-architecture.png\" alt=\"Tracing architecture\"></p>\n<p>The central element of the tracing architecture in Kyma is istio-jaeger. This main component serves both as a target of all query requests made from the Jaeger UI and the space for storing and processing the spans and traces created by Envoy and Kyma services.</p>\n<h2 id=\"request-traces\">Request traces</h2>\n<ol>\n<li>Kyma user accesses Jaeger UI and requests the trace details for a given service by selecting the service from the <strong>Services</strong> drop-down menu and confirming the choice by selecting the <strong>Find Traces</strong> button.</li>\n<li>Jaeger passes the request to the the UI facade, jaeger-query.</li>\n<li>The jaeger-query forwards the details to the istio-jaeger component which sends the information back.</li>\n</ol>\n<p><img src=\"assets/request-traces.png\" alt=\"Request traces\"></p>\n<h2 id=\"store-traces\">Store traces</h2>\n<ol>\n<li>Kyma user configures the application to propagate the correct <a href=\"https://istio.io/docs/tasks/telemetry/distributed-tracing.html#understanding-what-happened\" target=\"_blank\">HTTP headers</a> for the outbound calls.</li>\n<li>Envoy passes the trace details to the Zipkin Kubernetes service. This service acts as a facade to receive the trace and span details.</li>\n<li>Zipkin service forwards the tracing information to the istio-jaeger component which processes the received details.</li>\n</ol>\n<p><img src=\"assets/store-traces.png\" alt=\"Store traces\"></p>\n"},{"order":"030-trace-comparison","title":"Trace Comparison","type":"Details","source":"<p>Trace comparison allows the structure of two traces to be compared. Each trace is rendered as a tree of connected services and operations. The comparison differences between two traces are color coded.</p>\n<h1 id=\"compare-traces\">Compare traces</h1>\n<p>Compare the traces using the <strong>Jaeger</strong> user interface.</p>\n<ol>\n<li><p>In the search page for traces, select the traces to compare and click <strong>Compare Traces</strong>.</p>\n<p><img src=\"assets/list-traces.png\" alt=\"Tracing architecture\"></p>\n</li>\n<li><p>The page shows the comparison of two traces selected in the previous step. The traces are marked with <strong>A</strong> and <strong>B</strong>.</p>\n<p><img src=\"assets/compare-traces-1.png\" alt=\"Tracing architecture\"></p>\n</li>\n<li><p>Use the top menus for <strong>A</strong> and <strong>B</strong> to select the traces you want to compare.</p>\n<p><img src=\"assets/compare-traces-2.png\" alt=\"Tracing architecture\"></p>\n<p>Trace spans have different colors which indicate their meaning:</p>\n<ul>\n<li>Dark colors indicate that the span is missing from one of the traces:<ul>\n<li>Dark red: The span is only present in trace <strong>A</strong>.</li>\n<li>Dark green: The span is only present in trace <strong>B</strong>.</li>\n</ul>\n</li>\n<li>Light colors indicate that the span is present in both traces but occurs more often in one of the traces:<ul>\n<li>Light red: The span in <strong>A</strong> has more spans than <strong>B</strong>.</li>\n<li>Light green: The span in B has more spans than <strong>A</strong>.</li>\n</ul>\n</li>\n<li>Gray: indicates that two traces have a span and the same number of further spans grouped in it.</li>\n</ul>\n<p>Additionally, spans are marked with numerical values indicating how often they occur in compared traces. The values can be positive or negative.</p>\n<blockquote>\n<p><strong>NOTE:</strong> Missing spans can be interpreted as either the application not calling the downstream service, which might be a bug, or that the downstream service is down.</p>\n</blockquote>\n<p><img src=\"assets/compare-traces-colors.png\" alt=\"Tracing architecture\"></p>\n</li>\n</ol>\n"}]},"navigation":{"topics":[{"id":"api-gateway","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Security","anchor":"security"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"Api","anchor":"api"}]}]},{"id":"application-connector","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Architecture","name":"Architecture","anchor":"architecture","titles":[{"name":"Application Connector components","anchor":"application-connector-components"},{"name":"Connector Service","anchor":"connector-service"},{"name":"Proxy Service","anchor":"proxy-service"}]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Security","anchor":"security"},{"name":"Access the Application Connector on a local Kyma deployment","anchor":"access-the-application-connector-on-a-local-kyma-deployment"},{"name":"Consume applications through the Service Catalog","anchor":"consume-applications-through-the-service-catalog"},{"name":"Metadata Service","anchor":"metadata-service"},{"name":"Pass an access token in a request header","anchor":"pass-an-access-token-in-a-request-header"}]},{"topicType":"API","name":"API","anchor":"api","titles":[{"name":"Connector Service","anchor":"connector-service"},{"name":"Metadata Service","anchor":"metadata-service"},{"name":"Event Service","anchor":"event-service"}]},{"topicType":"Getting Started","name":"Getting Started","anchor":"getting-started","titles":[{"name":"Create a new Remote Environment","anchor":"create-a-new-remote-environment"},{"name":"Get the client certificate","anchor":"get-the-client-certificate"},{"name":"Register a service","anchor":"register-a-service"},{"name":"Bind a Remote Environment to an Environment","anchor":"bind-a-remote-environment-to-an-environment"},{"name":"Trigger a lambda with events","anchor":"trigger-a-lambda-with-events"},{"name":"Call a registered external service from Kyma","anchor":"call-a-registered-external-service-from-kyma"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"RemoteEnvironment","anchor":"remoteenvironment"},{"name":"EnvironmentMapping","anchor":"environmentmapping"}]}]},{"id":"console","contentType":"components","sections":[{"topicType":"Overview","name":"Overview","anchor":"overview","titles":[{"name":"Overview","anchor":"overview"}]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"UI extensibility","anchor":"ui-extensibility"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"MicroFrontend","anchor":"microfrontend"},{"name":"ClusterMicroFrontend","anchor":"clustermicrofrontend"}]}]},{"id":"event-bus","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Basic concepts","anchor":"basic-concepts"},{"name":"Event flow requirements","anchor":"event-flow-requirements"},{"name":"Service Programming Model","anchor":"service-programming-model"},{"name":"Troubleshooting","anchor":"troubleshooting"},{"name":"Subscription updates","anchor":"subscription-updates"}]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"Subscription","anchor":"subscription"}]},{"topicType":null,"name":"CLI reference","anchor":"cli-reference","titles":[]}]},{"id":"logging","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Access OK Log","anchor":"access-ok-log"}]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]}]},{"id":"monitoring","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":"Getting Started","name":"Getting Started","anchor":"getting-started","titles":[{"name":"Expose custom metrics in Kyma","anchor":"expose-custom-metrics-in-kyma"}]}]},{"id":"security","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Kubeconfig generator","anchor":"kubeconfig-generator"},{"name":"Add an Identity Provider to Dex","anchor":"add-an-identity-provider-to-dex"},{"name":"Manage static users in Dex","anchor":"manage-static-users-in-dex"},{"name":"Update TLS certificate","anchor":"update-tls-certificate"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"Group","anchor":"group"},{"name":"Identity Provider Presets","anchor":"identity-provider-presets"}]}]},{"id":"serverless","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Custom Resources","anchor":"custom-resources"},{"name":"Managing Lambdas","anchor":"managing-lambdas"},{"name":"The Node.js Programming Model","anchor":"the-node.js-programming-model"}]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":null,"name":"CLI reference","anchor":"cli-reference","titles":[]}]},{"id":"service-brokers","contentType":"components","sections":[{"topicType":"Overview","name":"Overview","anchor":"overview","titles":[{"name":"Overview","anchor":"overview"},{"name":"Azure Broker","anchor":"azure-broker"},{"name":"Remote Environment Broker","anchor":"remote-environment-broker"},{"name":"Helm Broker","anchor":"helm-broker"}]},{"topicType":"Configuration","name":"Configuration","anchor":"configuration","titles":[{"name":"Configure Helm Broker","anchor":"configure-helm-broker"},{"name":"How to create a bundle","anchor":"how-to-create-a-bundle"},{"name":"Binding bundles","anchor":"binding-bundles"},{"name":"Enable the Azure Broker for local deployment","anchor":"enable-the-azure-broker-for-local-deployment"}]},{"topicType":"Architecture","name":"Architecture","anchor":"architecture","titles":[{"name":"The Remote Environment Broker architecture","anchor":"the-remote-environment-broker-architecture"},{"name":"Helm Broker architecture","anchor":"helm-broker-architecture"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"EventActivation","anchor":"eventactivation"}]}]},{"id":"service-catalog","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Resources","anchor":"resources"},{"name":"Add a service to the Catalog","anchor":"add-a-service-to-the-catalog"},{"name":"Provisioning and binding","anchor":"provisioning-and-binding"},{"name":"Etcd Database","anchor":"etcd-database"}]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]},{"topicType":null,"name":"CLI reference","anchor":"cli-reference","titles":[]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"ServiceBindingUsage","anchor":"servicebindingusage"},{"name":"UsageKind","anchor":"usagekind"}]},{"topicType":"Getting Started","name":"Getting Started","anchor":"getting-started","titles":[{"name":"Register a ClusterServiceBroker","anchor":"register-a-clusterservicebroker"}]}]},{"id":"service-mesh","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Sidecar Proxy Injection","anchor":"sidecar-proxy-injection"},{"name":"Istio patch","anchor":"istio-patch"}]}]},{"id":"tracing","contentType":"components","sections":[{"topicType":null,"name":"Overview","anchor":"overview","titles":[]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Propagate HTTP headers","anchor":"propagate-http-headers"},{"name":"Trace Comparison","anchor":"trace-comparison"}]},{"topicType":null,"name":"Architecture","anchor":"architecture","titles":[]}]},{"id":"kyma","contentType":"root","sections":[{"topicType":"Overview","name":"Overview","anchor":"overview","titles":[{"name":"In a nutshell","anchor":"in-a-nutshell"},{"name":"Main features","anchor":"main-features"},{"name":"Technology stack","anchor":"technology-stack"},{"name":"Key components","anchor":"key-components"},{"name":"Kyma and Knative - brothers in arms","anchor":"kyma-and-knative---brothers-in-arms"},{"name":"How to start","anchor":"how-to-start"}]},{"topicType":"Details","name":"Details","anchor":"details","titles":[{"name":"Components","anchor":"components"},{"name":"Environments","anchor":"environments"},{"name":"Testing Kyma","anchor":"testing-kyma"},{"name":"Charts","anchor":"charts"},{"name":"Deploy with a private Docker registry","anchor":"deploy-with-a-private-docker-registry"}]},{"topicType":"Installation","name":"Installation","anchor":"installation","titles":[{"name":"Install Kyma locally from the release","anchor":"install-kyma-locally-from-the-release"},{"name":"Install Kyma locally from sources","anchor":"install-kyma-locally-from-sources"},{"name":"Install Kyma on a GKE cluster","anchor":"install-kyma-on-a-gke-cluster"},{"name":"Local installation scripts","anchor":"local-installation-scripts"},{"name":"Install subcomponents","anchor":"install-subcomponents"},{"name":"Reinstall Kyma","anchor":"reinstall-kyma"},{"name":"Installation with custom Istio deployment","anchor":"installation-with-custom-istio-deployment"}]},{"topicType":"Getting Started","name":"Getting Started","anchor":"getting-started","titles":[{"name":"Sample service deployment on local","anchor":"sample-service-deployment-on-local"},{"name":"Sample service deployment on a cluster","anchor":"sample-service-deployment-on-a-cluster"},{"name":"Develop a service locally without using Docker","anchor":"develop-a-service-locally-without-using-docker"},{"name":"Publish a service Docker image and deploy it to Kyma","anchor":"publish-a-service-docker-image-and-deploy-it-to-kyma"},{"name":"Helm overrides for Kyma installation","anchor":"helm-overrides-for-kyma-installation"}]},{"topicType":"Custom Resource","name":"Custom Resource","anchor":"custom-resource","titles":[{"name":"Installation","anchor":"installation"}]}]}]},"includeVersionInPath":true,"currentVersion":"0.5","versions":["0.5","0.4"],"manifest":{"metadata":{"name":"kyma-docs"},"spec":{"root":{"displayName":"Kyma","id":"kyma"},"components":[{"displayName":"Security","id":"security"},{"displayName":"Service Catalog","id":"service-catalog"},{"displayName":"Service Brokers","id":"service-brokers"},{"displayName":"Application Connector","id":"application-connector"},{"displayName":"Event Bus","id":"event-bus"},{"displayName":"Service Mesh","id":"service-mesh"},{"displayName":"Serverless","id":"serverless"},{"displayName":"Monitoring","id":"monitoring"},{"displayName":"Tracing","id":"tracing"},{"displayName":"API Gateway","id":"api-gateway"},{"displayName":"Logging","id":"logging"},{"displayName":"Console","id":"console"}]}}}}